<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Tableau de Bord - Predikta</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
    <body>
    <div class="bg-animation"></div>
    
    <!-- Mobile Header -->
    <div class="mobile-header">
        <div class="mobile-logo">
            <i class="fas fa-chart-line"></i>
            Predikta
        </div>
        <div class="mobile-actions">
            <button class="icon-btn" onclick="openModal('eventModal')">
                <i class="fas fa-plus"></i>
            </button>
            <button class="icon-btn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </div>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" onclick="closeSidebar()"></div>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <i class="fas fa-chart-line"></i>
                Predikta
            </div>
            <button class="sidebar-close" onclick="closeSidebar()">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="user-info">
            <div class="user-avatar" id="userAvatar">A</div>
            <div class="user-name" id="userName">Admin</div>
            <div class="user-pseudo" id="userPseudo">@admin</div>
            <div class="balance-card">
                <div class="balance-label">Total Revenus</div>
                <div class="balance-value" id="totalRevenueDisplay">0 FCFA</div>
            </div>
        </div>

        <div class="nav-section">
            <div class="nav-section-title">Menu Principal</div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a class="nav-link active" onclick="showSection('dashboard'); closeSidebar();">
                        <i class="fas fa-home"></i>
                        Tableau de Bord
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showSection('events'); closeSidebar();">
                        <i class="fas fa-calendar-alt"></i>
                        Événements
                        <span class="badge" id="eventCountBadge">0</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showSection('transactions'); closeSidebar();">
                        <i class="fas fa-exchange-alt"></i>
                        Transactions
                        <span class="badge" id="transactionCountBadge">0</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showSection('users'); closeSidebar();">
                        <i class="fas fa-users"></i>
                        Utilisateurs
                    </a>
                </li>
            </ul>
        </div>

        <div class="nav-section">
            <div class="nav-section-title">Paramètres</div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a class="nav-link" onclick="showSection('settings'); closeSidebar();">
                        <i class="fas fa-cog"></i>
                        Configuration
                    </a>
                </li>
            </ul>
        </div>

        <button class="btn-logout" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i>
            Déconnexion
        </button>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard-section" class="content-section active">
            <div class="page-header">
                <h1 class="page-title">Tableau de <span>bord</span></h1>
                <p class="page-subtitle">Gérez votre plateforme de prédiction</p>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openModal('eventModal')">
                        <i class="fas fa-plus"></i>
                        Nouvel Événement
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <div class="quick-action" onclick="showSection('events'); openModal('eventModal');">
                    <div class="quick-action-icon">
                        <i class="fas fa-calendar-plus"></i>
                    </div>
                    <div class="quick-action-title">Créer Événement</div>
                    <div class="quick-action-desc">Ajouter un nouvel événement</div>
                </div>
                <div class="quick-action pink" onclick="showSection('transactions')">
                    <div class="quick-action-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="quick-action-title">Valider Transactions</div>
                    <div class="quick-action-desc">Approuver dépôts/retraits</div>
                </div>
                <div class="quick-action green" onclick="showSection('users')">
                    <div class="quick-action-icon">
                        <i class="fas fa-user-cog"></i>
                    </div>
                    <div class="quick-action-title">Gérer Utilisateurs</div>
                    <div class="quick-action-desc">Voir les utilisateurs</div>
                </div>
                <div class="quick-action orange" onclick="showSection('settings')">
                    <div class="quick-action-icon">
                        <i class="fas fa-sliders-h"></i>
                    </div>
                    <div class="quick-action-title">Configuration</div>
                    <div class="quick-action-desc">Paramètres système</div>
                </div>
            </div>

            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div>
                            <div class="stat-value" id="totalEvents">0</div>
                            <div class="stat-label">Événements Actifs</div>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-calendar"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i> En cours
                    </div>
                </div>

                <div class="stat-card pink">
                    <div class="stat-header">
                        <div>
                            <div class="stat-value" id="totalRevenue">0 FCFA</div>
                            <div class="stat-label">Revenus Totaux</div>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i> Commission 2%
                    </div>
                </div>

                <div class="stat-card blue">
                    <div class="stat-header">
                        <div>
                            <div class="stat-value" id="totalUsers">0</div>
                            <div class="stat-label">Utilisateurs</div>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                    </div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i> Total inscrits
                    </div>
                </div>

                <div class="stat-card orange">
                    <div class="stat-header">
                        <div>
                            <div class="stat-value" id="pendingTransactions">0</div>
                            <div class="stat-label">Transactions en Attente</div>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                    </div>
                    <div class="stat-change negative" id="pendingAlert">
                        <i class="fas fa-exclamation-circle"></i> Action requise
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="section">
                <div class="section-header">
                    <h3 class="section-title">
                        <i class="fas fa-bell"></i>
                        Activité Récente
                    </h3>
                    <button class="btn btn-secondary btn-sm" onclick="showSection('transactions')">
                        Voir tout
                    </button>
                </div>
                <div class="card">
                    <div id="recentActivity">
                        <div class="empty-state">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Chargement...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Events Section -->
        <section id="events-section" class="content-section">
            <div class="page-header">
                <h1 class="page-title">Gestion des <span>Événements</span></h1>
                <p class="page-subtitle">Créez et gérez les événements de prédiction</p>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="openModal('eventModal')">
                        <i class="fas fa-plus"></i>
                        Créer un Événement
                    </button>
                </div>
            </div>

            <div class="filters">
                <button class="filter-btn active" onclick="filterEvents('all', this)">Tous</button>
                <button class="filter-btn" onclick="filterEvents('active', this)">Actifs</button>
                <button class="filter-btn" onclick="filterEvents('pending', this)">En attente</button>
                <button class="filter-btn" onclick="filterEvents('completed', this)">Terminés</button>
                <button class="filter-btn" onclick="filterEvents('cancelled', this)">Annulés</button>
            </div>

            <div id="eventsList" class="events-grid">
                <div class="empty-state" style="grid-column: 1/-1;">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Chargement des événements...</p>
                </div>
            </div>
        </section>

        <!-- Transactions Section -->
        <section id="transactions-section" class="content-section">
            <div class="page-header">
                <h1 class="page-title">Validation des <span>Transactions</span></h1>
                <p class="page-subtitle">Approuvez ou rejetez les demandes de dépôt et retrait</p>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="refreshTransactions()">
                        <i class="fas fa-sync"></i>
                        Actualiser
                    </button>
                </div>
            </div>

            <!-- Pending Deposits -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-arrow-down" style="color: var(--success);"></i>
                        Dépôts en Attente
                    </div>
                </div>
                <div id="pendingDepositsList" class="payment-list">
                    <div class="empty-state">
                        <i class="fas fa-check-circle"></i>
                        <p>Aucun dépôt en attente</p>
                    </div>
                </div>
            </div>

            <!-- Pending Withdrawals -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-arrow-up" style="color: var(--danger);"></i>
                        Retraits en Attente
                    </div>
                </div>
                <div id="pendingWithdrawalsList" class="payment-list">
                    <div class="empty-state">
                        <i class="fas fa-check-circle"></i>
                        <p>Aucun retrait en attente</p>
                    </div>
                </div>
            </div>

            <!-- History -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-history"></i>
                        Historique des Transactions
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Utilisateur</th>
                                <th>Montant</th>
                                <th>Infos</th>
                                <th>Date</th>
                                <th>Statut</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsHistoryTable">
                            <tr>
                                <td colspan="7" style="text-align: center; padding: 2rem;">
                                    Chargement...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Users Section -->
        <section id="users-section" class="content-section">
            <div class="page-header">
                <h1 class="page-title">Gestion des <span>Utilisateurs</span></h1>
                <p class="page-subtitle">Vue d'ensemble des utilisateurs de la plateforme</p>
            </div>

            <div class="card">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Utilisateur</th>
                                <th>Contact</th>
                                <th>Solde</th>
                                <th>En attente</th>
                                <th>Paris</th>
                                <th>Statut</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable">
                            <tr>
                                <td colspan="7" style="text-align: center; padding: 2rem;">
                                    Chargement...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings-section" class="content-section">
            <div class="page-header">
                <h1 class="page-title">Paramètres <span>Système</span></h1>
                <p class="page-subtitle">Configurez les options de la plateforme</p>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">Configuration Générale</div>
                </div>
                <div class="form-group">
                    <label>Commission sur les gains (%)</label>
                    <input type="number" id="commissionRate" value="2" min="0" max="100" step="0.5">
                </div>
                <div class="form-group">
                    <label>Mise minimum (FCFA)</label>
                    <input type="number" id="minBet" value="100" min="50" step="50">
                </div>
                <div class="form-group">
                    <label>Mise maximum (FCFA)</label>
                    <input type="number" id="maxBet" value="100000" min="1000" step="1000">
                </div>
                <div class="form-group">
                    <label>Minimum de retrait (FCFA)</label>
                    <input type="number" id="minWithdrawal" value="1000" min="100" step="100">
                </div>
                <button class="btn btn-primary" onclick="saveSettings()">
                    <i class="fas fa-save"></i>
                    Enregistrer
                </button>
            </div>
        </section>
    </main>

    <!-- Event Modal -->
    <div class="modal-overlay" id="eventModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="eventModalTitle">Nouvel Événement</h3>
                <button class="modal-close" onclick="closeModal('eventModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="eventForm">
                    <input type="hidden" id="eventId">
                    
                    <div class="form-group">
                        <label>Question de prédiction *</label>
                        <input type="text" id="eventQuestion" required placeholder="Ex: Le Real Madrid remportera-t-il la Liga cette saison ?">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Catégorie *</label>
                            <select id="eventCategory" required>
                                <option value="sport">Sport</option>
                                <option value="politique">Politique</option>
                                <option value="entertainment">Divertissement</option>
                                <option value="crypto">Crypto</option>
                                <option value="music">Musique</option>
                                <option value="autre">Autre</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Date de clôture *</label>
                            <input type="datetime-local" id="eventDate" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Description (optionnel)</label>
                        <textarea id="eventDescription" placeholder="Contexte et détails de l'événement..."></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Mise minimum (FCFA)</label>
                            <input type="number" id="eventMinBet" value="100" min="50" step="50">
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="eventStatus">
                                <option value="active">Actif</option>
                                <option value="pending">En attente</option>
                                <option value="completed">Terminé</option>
                                <option value="cancelled">Annulé</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('eventModal')">Annuler</button>
                <button class="btn btn-primary" onclick="saveEvent()">
                    <i class="fas fa-save"></i>
                    Enregistrer
                </button>
            </div>
        </div>
    </div>

    <!-- Transaction Validation Modal -->
    <div class="modal-overlay" id="transactionModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="transactionModalTitle">Valider la Transaction</h3>
                <button class="modal-close" onclick="closeModal('transactionModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="transactionId">
                <input type="hidden" id="transactionType">
                <input type="hidden" id="transactionUserId">
                
                <div class="payment-item" style="margin-bottom: 1.5rem; background: rgba(99, 102, 241, 0.1);">
                    <div class="payment-avatar" id="transactionUserAvatar">U</div>
                    <div class="payment-info">
                        <div class="payment-user" id="transactionUserName">Utilisateur</div>
                        <div class="payment-details" id="transactionDetails">Détails</div>
                    </div>
                    <div class="payment-amount" id="transactionAmount">0 FCFA</div>
                </div>

                <div id="transactionScreenshotContainer" class="form-group" style="display: none;">
                    <label>Capture d'écran</label>
                    <img id="transactionScreenshot" src="" alt="Screenshot" style="max-width: 100%; border-radius: 10px; border: 1px solid rgba(255,255,255,0.1);">
                </div>

                <div class="form-group">
                    <label>Action *</label>
                    <select id="transactionAction">
                        <option value="approve">✅ Approuver</option>
                        <option value="reject">❌ Rejeter</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Commentaire (optionnel)</label>
                    <textarea id="transactionComment" placeholder="Raison de la décision..."></textarea>
                </div>

                <div class="info-box" style="background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); border-radius: 10px; padding: 1rem;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; color: var(--warning); font-size: 0.9rem;">
                        <i class="fas fa-info-circle"></i>
                        <span id="transactionWarningText">Le solde de l'utilisateur sera mis à jour automatiquement</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('transactionModal')">Annuler</button>
                <button class="btn btn-primary" onclick="processTransaction()">
                    <i class="fas fa-check"></i>
                    Confirmer
                </button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Message</span>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js">
    <script src="script.js"></script>
</body>
</html>
