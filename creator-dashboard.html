<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>Tableau de Bord Créateur - Predikta</title>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #7c3aed;
            --primary-light: #a855f7;
            --primary-glow: rgba(124, 58, 237, 0.35);
            --accent: #f43f5e;
            --accent-light: #fb7185;
            --success: #10b981;
            --success-glow: rgba(16, 185, 129, 0.3);
            --danger: #f43f5e;
            --danger-glow: rgba(244, 63, 94, 0.3);
            --warning: #f59e0b;
            --info: #0ea5e9;
            --bg: #07080f;
            --bg-card: #0d0f1e;
            --bg-elevated: #121428;
            --bg-hover: #181b33;
            --border: rgba(255,255,255,0.07);
            --border-glow: rgba(124,58,237,0.3);
            --text: #f0f0ff;
            --text-muted: #6b7094;
            --text-dim: #9399c2;
            --grad: linear-gradient(135deg, #7c3aed 0%, #f43f5e 100%);
            --grad-success: linear-gradient(135deg, #10b981 0%, #059669 100%);
            --grad-danger: linear-gradient(135deg, #f43f5e 0%, #dc2626 100%);
            --grad-warm: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
            --sidebar-w: 260px;
            --header-h: 60px;
            --radius: 14px;
            --radius-sm: 8px;
            --radius-lg: 20px;
            --shadow: 0 8px 32px rgba(0,0,0,0.4);
            --shadow-glow: 0 0 40px rgba(124,58,237,0.15);
        }

        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

        html { scroll-behavior: smooth; }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Noise texture overlay */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
            pointer-events: none;
            z-index: 0;
            opacity: 0.4;
        }

        /* ── LAYOUT ── */
        .layout {
            display: flex;
            min-height: 100vh;
        }

        /* ── SIDEBAR ── */
        .sidebar {
            width: var(--sidebar-w);
            background: var(--bg-card);
            border-right: 1px solid var(--border);
            position: fixed;
            top: 0; left: 0; bottom: 0;
            display: flex;
            flex-direction: column;
            z-index: 200;
            transition: transform 0.3s cubic-bezier(0.4,0,0.2,1);
            overflow-y: auto;
            scrollbar-width: none;
        }
        .sidebar::-webkit-scrollbar { display: none; }

        .sidebar-top {
            padding: 1.5rem 1.25rem 1rem;
            border-bottom: 1px solid var(--border);
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            margin-bottom: 1.5rem;
        }

        .brand-icon {
            width: 38px; height: 38px;
            background: var(--grad);
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1rem;
            color: #fff;
            box-shadow: 0 4px 16px var(--primary-glow);
            flex-shrink: 0;
        }

        .brand-name {
            font-family: 'Syne', sans-serif;
            font-size: 1.3rem;
            font-weight: 800;
            background: var(--grad);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .user-card {
            background: linear-gradient(135deg, rgba(124,58,237,0.12) 0%, rgba(244,63,94,0.08) 100%);
            border: 1px solid var(--border-glow);
            border-radius: var(--radius);
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 0.875rem;
        }

        .avatar {
            width: 42px; height: 42px;
            background: var(--grad);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-family: 'Syne', sans-serif;
            font-weight: 700;
            font-size: 1rem;
            color: #fff;
            flex-shrink: 0;
        }

        .user-meta { min-width: 0; }
        .user-name {
            font-weight: 600;
            font-size: 0.875rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .user-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            font-size: 0.68rem;
            font-weight: 600;
            color: var(--primary-light);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 0.15rem;
        }

        .nav { padding: 1rem 0.875rem; flex: 1; }

        .nav-label {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-muted);
            padding: 0 0.5rem;
            margin-bottom: 0.5rem;
            margin-top: 1rem;
        }
        .nav-label:first-child { margin-top: 0; }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.7rem 0.875rem;
            color: var(--text-dim);
            text-decoration: none;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 0.125rem;
            border: 1px solid transparent;
        }

        .nav-link:hover {
            background: var(--bg-hover);
            color: var(--text);
        }

        .nav-link.active {
            background: linear-gradient(135deg, rgba(124,58,237,0.18) 0%, rgba(244,63,94,0.08) 100%);
            color: var(--text);
            border-color: var(--border-glow);
        }

        .nav-link .icon {
            width: 32px; height: 32px;
            border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            font-size: 0.8rem;
            flex-shrink: 0;
            background: rgba(255,255,255,0.05);
            transition: all 0.2s;
        }

        .nav-link.active .icon,
        .nav-link:hover .icon {
            background: rgba(124,58,237,0.2);
            color: var(--primary-light);
        }

        .sidebar-bottom {
            padding: 1rem 0.875rem;
            border-top: 1px solid var(--border);
        }

        .btn-logout {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 100%;
            padding: 0.7rem 0.875rem;
            background: rgba(244,63,94,0.08);
            border: 1px solid rgba(244,63,94,0.2);
            border-radius: var(--radius-sm);
            color: var(--accent-light);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-logout:hover {
            background: rgba(244,63,94,0.15);
        }

        /* ── MOBILE HEADER ── */
        .mobile-header {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0;
            height: var(--header-h);
            background: rgba(13,15,30,0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            align-items: center;
            justify-content: space-between;
            padding: 0 1rem;
            z-index: 300;
        }

        .mobile-brand {
            display: flex;
            align-items: center;
            gap: 0.625rem;
            font-family: 'Syne', sans-serif;
            font-size: 1.1rem;
            font-weight: 800;
            background: var(--grad);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .mobile-brand-icon {
            width: 30px; height: 30px;
            background: var(--grad);
            border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            font-size: 0.8rem;
            color: #fff;
            -webkit-text-fill-color: #fff;
            flex-shrink: 0;
        }

        .mobile-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .icon-btn {
            width: 36px; height: 36px;
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
            font-size: 0.875rem;
        }
        .icon-btn:hover { border-color: var(--border-glow); }

        .badge-dot {
            position: absolute;
            top: 5px; right: 5px;
            width: 8px; height: 8px;
            background: var(--accent);
            border-radius: 50%;
            border: 2px solid var(--bg-card);
        }

        .overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            z-index: 190;
            backdrop-filter: blur(4px);
        }
        .overlay.active { display: block; }

        /* ── MAIN ── */
        .main {
            margin-left: var(--sidebar-w);
            flex: 1;
            min-height: 100vh;
            position: relative;
        }

        .content {
            padding: 2rem;
            max-width: 1400px;
        }

        /* ── PAGE HEADER ── */
        .page-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.75rem;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .page-title {
            font-family: 'Syne', sans-serif;
            font-size: 1.625rem;
            font-weight: 800;
        }

        .page-title span {
            background: var(--grad);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        /* ── BUTTONS ── */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.65rem 1.25rem;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            white-space: nowrap;
            font-family: 'DM Sans', sans-serif;
        }

        .btn-primary {
            background: var(--grad);
            color: #fff;
            box-shadow: 0 4px 16px var(--primary-glow);
        }
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 24px var(--primary-glow);
        }

        .btn-success {
            background: var(--grad-success);
            color: #fff;
            box-shadow: 0 4px 16px var(--success-glow);
        }
        .btn-success:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 24px var(--success-glow);
        }

        .btn-danger {
            background: var(--grad-danger);
            color: #fff;
        }

        .btn-ghost {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
        }
        .btn-ghost:hover {
            border-color: var(--border-glow);
            color: var(--text);
        }

        .btn-sm { padding: 0.5rem 0.875rem; font-size: 0.8rem; }
        .btn-full { width: 100%; justify-content: center; }

        /* ── COMMISSION BANNER ── */
        .commission-banner {
            background: linear-gradient(135deg, rgba(124,58,237,0.15) 0%, rgba(244,63,94,0.1) 100%);
            border: 1px solid var(--border-glow);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.75rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            flex-wrap: wrap;
            position: relative;
            overflow: hidden;
        }

        .commission-banner::after {
            content: '';
            position: absolute;
            right: -40px; top: -40px;
            width: 180px; height: 180px;
            background: radial-gradient(circle, rgba(124,58,237,0.12) 0%, transparent 70%);
            pointer-events: none;
        }

        .commission-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .commission-icon {
            width: 52px; height: 52px;
            background: var(--grad);
            border-radius: var(--radius);
            display: flex; align-items: center; justify-content: center;
            font-size: 1.4rem;
            flex-shrink: 0;
            box-shadow: 0 4px 20px var(--primary-glow);
        }

        .commission-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.06em;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .commission-value {
            font-family: 'Syne', sans-serif;
            font-size: 2rem;
            font-weight: 800;
            background: var(--grad);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }

        .commission-desc {
            font-size: 0.75rem;
            color: var(--text-dim);
            margin-top: 0.25rem;
        }

        /* ── STATS GRID ── */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 1.75rem;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.25rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.25s;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 2px;
            opacity: 0;
            transition: opacity 0.25s;
        }

        .stat-card:hover { border-color: var(--border-glow); transform: translateY(-2px); }
        .stat-card:hover::before { opacity: 1; }
        .stat-card.purple::before { background: var(--grad); }
        .stat-card.green::before { background: var(--grad-success); }
        .stat-card.orange::before { background: var(--grad-warm); }
        .stat-card.blue::before { background: linear-gradient(135deg, #0ea5e9, #6366f1); }

        .stat-icon-wrap {
            width: 44px; height: 44px;
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }
        .stat-icon-wrap.purple { background: rgba(124,58,237,0.15); color: var(--primary-light); }
        .stat-icon-wrap.green { background: rgba(16,185,129,0.15); color: var(--success); }
        .stat-icon-wrap.orange { background: rgba(245,158,11,0.15); color: var(--warning); }
        .stat-icon-wrap.blue { background: rgba(14,165,233,0.15); color: var(--info); }

        .stat-info { min-width: 0; }
        .stat-val {
            font-family: 'Syne', sans-serif;
            font-size: 1.375rem;
            font-weight: 700;
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .stat-lbl { font-size: 0.75rem; color: var(--text-muted); margin-top: 0.2rem; }

        /* ── TABS ── */
        .tabs-bar {
            display: flex;
            gap: 0.25rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 0.375rem;
            margin-bottom: 1.5rem;
            overflow-x: auto;
            scrollbar-width: none;
        }
        .tabs-bar::-webkit-scrollbar { display: none; }

        .tab-btn {
            flex: 1;
            min-width: max-content;
            padding: 0.6rem 1rem;
            background: transparent;
            border: none;
            border-radius: var(--radius-sm);
            color: var(--text-muted);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            font-family: 'DM Sans', sans-serif;
        }

        .tab-btn.active {
            background: var(--bg-elevated);
            color: var(--text);
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        .tab-pane { display: none; }
        .tab-pane.active { display: block; }

        /* ── CARDS / SECTIONS ── */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.25rem;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .card-title {
            font-family: 'Syne', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card-title i { color: var(--primary-light); font-size: 0.9rem; }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.25rem;
            margin-bottom: 1.75rem;
        }

        /* ── TABLE ── */
        .table-wrap {
            overflow-x: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) transparent;
        }
        .table-wrap::-webkit-scrollbar { height: 4px; }
        .table-wrap::-webkit-scrollbar-track { background: transparent; }
        .table-wrap::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 2px; }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
            min-width: 580px;
        }

        thead th {
            padding: 0.75rem 1rem;
            text-align: left;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border);
            white-space: nowrap;
        }

        tbody td {
            padding: 0.875rem 1rem;
            border-bottom: 1px solid var(--border);
            color: var(--text-dim);
        }

        tbody tr:last-child td { border-bottom: none; }
        tbody tr:hover td { background: rgba(255,255,255,0.02); color: var(--text); }

        /* ── BADGES ── */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.3rem 0.7rem;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            white-space: nowrap;
        }
        .badge::before {
            content: '';
            width: 5px; height: 5px;
            border-radius: 50%;
        }
        .badge.active { background: rgba(16,185,129,0.12); color: var(--success); }
        .badge.active::before { background: var(--success); }
        .badge.pending { background: rgba(245,158,11,0.12); color: var(--warning); }
        .badge.pending::before { background: var(--warning); }
        .badge.closed, .badge.rejected { background: rgba(244,63,94,0.12); color: var(--danger); }
        .badge.closed::before, .badge.rejected::before { background: var(--danger); }
        .badge.approved, .badge.won { background: rgba(16,185,129,0.12); color: var(--success); }
        .badge.approved::before, .badge.won::before { background: var(--success); }
        .badge.lost { background: rgba(244,63,94,0.12); color: var(--danger); }
        .badge.lost::before { background: var(--danger); }

        /* ── ACTION BTNS ── */
        .actions { display: flex; gap: 0.375rem; }

        .act-btn {
            width: 30px; height: 30px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-size: 0.75rem;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        .act-btn.view { background: rgba(16,185,129,0.12); color: var(--success); }
        .act-btn.view:hover { background: var(--success); color: #fff; }
        .act-btn.result { background: rgba(245,158,11,0.12); color: var(--warning); }
        .act-btn.result:hover { background: var(--warning); color: #fff; }
        .act-btn.del { background: rgba(244,63,94,0.12); color: var(--danger); }
        .act-btn.del:hover { background: var(--danger); color: #fff; }

        /* ── EVENT CARD ── */
        .event-card {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.125rem;
            margin-bottom: 0.875rem;
            transition: border-color 0.2s;
        }
        .event-card:last-child { margin-bottom: 0; }
        .event-card:hover { border-color: var(--border-glow); }

        .event-card-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
            flex-wrap: wrap;
        }

        .cat-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.25rem 0.625rem;
            background: rgba(124,58,237,0.12);
            border: 1px solid rgba(124,58,237,0.2);
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--primary-light);
            text-transform: uppercase;
        }

        .event-q {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 0.75rem;
            line-height: 1.5;
        }

        .event-meta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.375rem;
            font-size: 0.78rem;
            color: var(--text-muted);
        }
        .meta-item i { font-size: 0.7rem; }
        .meta-item.yes i { color: var(--success); }
        .meta-item.no i { color: var(--danger); }
        .meta-item.pot i { color: var(--primary-light); }

        /* ── MODAL ── */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.75);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 500;
            backdrop-filter: blur(8px);
            padding: 1rem;
        }
        .modal-overlay.active { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1.75rem;
            max-width: 540px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            scrollbar-width: thin;
            animation: modalIn 0.3s cubic-bezier(0.34,1.56,0.64,1);
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.92) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-family: 'Syne', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
        }

        .modal-close {
            width: 32px; height: 32px;
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-muted);
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
        }
        .modal-close:hover { color: var(--text); border-color: var(--border-glow); }

        /* ── FORM ── */
        .form-group { margin-bottom: 1.125rem; }

        .form-label {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-dim);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text);
            font-size: 0.9rem;
            font-family: 'DM Sans', sans-serif;
            transition: all 0.2s;
        }
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124,58,237,0.15);
        }
        .form-control::placeholder { color: var(--text-muted); }

        textarea.form-control { min-height: 90px; resize: vertical; }

        /* ── RESULT OPTIONS ── */
        .result-opts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1.25rem 0;
        }

        .result-opt {
            padding: 1.25rem;
            border-radius: var(--radius);
            border: 2px solid var(--border);
            background: var(--bg-elevated);
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }
        .result-opt:hover { border-color: rgba(255,255,255,0.2); transform: translateY(-2px); }
        .result-opt.selected.yes { border-color: var(--success); background: rgba(16,185,129,0.1); }
        .result-opt.selected.no { border-color: var(--danger); background: rgba(244,63,94,0.1); }
        .result-opt i { font-size: 1.75rem; margin-bottom: 0.5rem; display: block; }
        .result-opt.yes-opt i { color: var(--success); }
        .result-opt.no-opt i { color: var(--danger); }
        .result-opt h4 { font-family: 'Syne', sans-serif; font-size: 1.1rem; margin-bottom: 0.2rem; }
        .result-opt p { font-size: 0.75rem; color: var(--text-muted); }

        /* ── SUMMARY BOX ── */
        .summary-box {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1rem;
            margin-bottom: 1.25rem;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border);
            font-size: 0.85rem;
        }
        .summary-row:last-child { border-bottom: none; }
        .summary-key { color: var(--text-muted); }
        .summary-val { font-weight: 600; }

        /* ── NOTIFICATION PANEL ── */
        .notif-panel {
            position: fixed;
            top: 0; right: -100%;
            width: 360px;
            max-width: 100%;
            height: 100vh;
            background: var(--bg-card);
            border-left: 1px solid var(--border);
            z-index: 400;
            transition: right 0.3s cubic-bezier(0.4,0,0.2,1);
            display: flex;
            flex-direction: column;
        }
        .notif-panel.active { right: 0; }

        .notif-head {
            padding: 1.25rem 1.25rem 1rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .notif-title {
            font-family: 'Syne', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .notif-title i { color: var(--primary-light); }

        .notif-list { flex: 1; overflow-y: auto; padding: 1rem; scrollbar-width: none; }

        .notif-item {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-left: 3px solid var(--primary);
            border-radius: var(--radius-sm);
            padding: 0.875rem;
            margin-bottom: 0.625rem;
        }
        .notif-item.success { border-left-color: var(--success); }
        .notif-item.error { border-left-color: var(--danger); }

        .notif-item-title { font-size: 0.85rem; font-weight: 600; margin-bottom: 0.25rem; }
        .notif-item-msg { font-size: 0.78rem; color: var(--text-muted); margin-bottom: 0.25rem; }
        .notif-item-time { font-size: 0.7rem; color: var(--text-muted); }

        /* ── EMPTY STATE ── */
        .empty {
            text-align: center;
            padding: 3rem 1.5rem;
            color: var(--text-muted);
        }
        .empty i { font-size: 2.5rem; margin-bottom: 0.875rem; display: block; opacity: 0.4; }
        .empty h4 { font-size: 0.95rem; font-weight: 600; margin-bottom: 0.375rem; color: var(--text-dim); }
        .empty p { font-size: 0.8rem; }

        /* ── TOAST ── */
        .toast {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 0.875rem 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.875rem;
            box-shadow: var(--shadow);
            z-index: 9999;
            max-width: 320px;
            transform: translateX(calc(100% + 2rem));
            opacity: 0;
            transition: all 0.35s cubic-bezier(0.34,1.56,0.64,1);
        }
        .toast.show { transform: translateX(0); opacity: 1; }
        .toast.success { border-color: rgba(16,185,129,0.4); }
        .toast.success i { color: var(--success); }
        .toast.error { border-color: rgba(244,63,94,0.4); }
        .toast.error i { color: var(--danger); }

        /* ── SPINNER ── */
        .spin {
            display: inline-block;
            width: 18px; height: 18px;
            border: 2px solid rgba(255,255,255,0.2);
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin 0.7s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ══════════════════════════════════════
           RESPONSIVE BREAKPOINTS
        ══════════════════════════════════════ */

        /* Tablettes larges / petits desktops */
        @media (max-width: 1100px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }

        /* Tablettes */
        @media (max-width: 900px) {
            :root { --sidebar-w: 0px; }

            .sidebar {
                width: 260px;
                transform: translateX(-100%);
            }
            .sidebar.open { transform: translateX(0); }

            .mobile-header { display: flex; }

            .main { margin-left: 0; padding-top: var(--header-h); }

            .content { padding: 1.25rem; }

            .grid-2 { grid-template-columns: 1fr; gap: 1rem; }

            .commission-banner { flex-direction: column; align-items: flex-start; }

            .stats-grid { grid-template-columns: repeat(2, 1fr); gap: 0.875rem; }

            .page-header { flex-direction: column; align-items: flex-start; }
            .header-right { width: 100%; justify-content: flex-end; }

            .notif-panel { width: 100%; }
        }

        /* Smartphones */
        @media (max-width: 600px) {
            .content { padding: 1rem; }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.625rem;
                margin-bottom: 1.25rem;
            }

            .stat-card { padding: 0.875rem; gap: 0.75rem; }
            .stat-icon-wrap { width: 36px; height: 36px; font-size: 0.8rem; border-radius: 8px; }
            .stat-val { font-size: 1.05rem; }
            .stat-lbl { font-size: 0.68rem; }

            .commission-banner { padding: 1rem; margin-bottom: 1.25rem; }
            .commission-icon { width: 42px; height: 42px; font-size: 1.1rem; border-radius: 10px; }
            .commission-value { font-size: 1.5rem; }
            .commission-desc { font-size: 0.7rem; }

            .page-title { font-size: 1.25rem; }

            .card { padding: 1rem; }
            .card-header { margin-bottom: 1rem; }

            .tabs-bar { padding: 0.25rem; }
            .tab-btn { font-size: 0.72rem; padding: 0.5rem 0.75rem; }

            .event-card { padding: 0.875rem; }
            .event-q { font-size: 0.85rem; }
            .event-meta { gap: 0.625rem; }
            .meta-item { font-size: 0.73rem; }

            .modal { padding: 1.25rem; border-radius: var(--radius); }
            .modal-title { font-size: 1rem; }

            .result-opts { gap: 0.75rem; }
            .result-opt { padding: 1rem 0.75rem; }
            .result-opt i { font-size: 1.4rem; }
            .result-opt h4 { font-size: 0.95rem; }
            .result-opt p { font-size: 0.7rem; }

            .summary-row { font-size: 0.8rem; }

            .btn { padding: 0.6rem 1rem; font-size: 0.82rem; }
            .btn-sm { padding: 0.45rem 0.75rem; font-size: 0.75rem; }

            .toast {
                bottom: 0.875rem;
                right: 0.875rem;
                left: 0.875rem;
                max-width: unset;
            }

            table { min-width: 520px; font-size: 0.8rem; }
            thead th { padding: 0.625rem 0.75rem; font-size: 0.65rem; }
            tbody td { padding: 0.75rem 0.75rem; }

            .act-btn { width: 26px; height: 26px; font-size: 0.68rem; }

            .modal-overlay { padding: 0.75rem; }
        }

        /* Très petits */
        @media (max-width: 380px) {
            .stats-grid { gap: 0.5rem; }
            .stat-card { padding: 0.75rem 0.625rem; }
            .stat-val { font-size: 0.95rem; }

            .tabs-bar { gap: 0.15rem; }
            .tab-btn { font-size: 0.68rem; padding: 0.45rem 0.5rem; }

            .commission-value { font-size: 1.25rem; }

            .mobile-brand { font-size: 0.95rem; }

            .result-opts { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<!-- Mobile Header -->
<header class="mobile-header" id="mobileHeader">
    <div class="mobile-brand">
        <div class="mobile-brand-icon"><i class="fas fa-chart-line"></i></div>
        Predikta
    </div>
    <div class="mobile-actions">
        <button class="icon-btn" onclick="toggleNotifPanel()">
            <i class="fas fa-bell"></i>
            <span class="badge-dot" id="badgeDot" style="display:none;"></span>
        </button>
        <button class="icon-btn" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </button>
    </div>
</header>

<!-- Overlays -->
<div class="overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>
<div class="overlay" id="notifOverlay" onclick="closeNotifPanel()"></div>

<!-- Notification Panel -->
<div class="notif-panel" id="notifPanel">
    <div class="notif-head">
        <div class="notif-title"><i class="fas fa-bell"></i> Notifications</div>
        <button class="modal-close" onclick="closeNotifPanel()"><i class="fas fa-times"></i></button>
    </div>
    <div class="notif-list" id="notifList">
        <div class="empty">
            <i class="fas fa-bell-slash"></i>
            <p>Aucune notification</p>
        </div>
    </div>
</div>

<div class="layout">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-top">
            <a class="brand" href="#">
                <div class="brand-icon"><i class="fas fa-chart-line"></i></div>
                <span class="brand-name">Predikta</span>
            </a>
            <div class="user-card">
                <div class="avatar" id="userAvatar">A</div>
                <div class="user-meta">
                    <div class="user-name" id="userName">Admin</div>
                    <div class="user-badge"><i class="fas fa-crown"></i> Créateur</div>
                </div>
            </div>
        </div>

        <nav class="nav">
            <div class="nav-label">Menu</div>
            <a class="nav-link active" onclick="showTab('overview'); closeSidebar();">
                <div class="icon"><i class="fas fa-home"></i></div>
                Vue d'ensemble
            </a>
            <a class="nav-link" onclick="showTab('events'); closeSidebar();">
                <div class="icon"><i class="fas fa-calendar-alt"></i></div>
                Événements
            </a>
            <a class="nav-link" onclick="showTab('results'); closeSidebar();">
                <div class="icon"><i class="fas fa-trophy"></i></div>
                Résultats
            </a>
            <a class="nav-link" onclick="showTab('users'); closeSidebar();">
                <div class="icon"><i class="fas fa-users"></i></div>
                Utilisateurs
            </a>
            <a class="nav-link" onclick="showTab('deposits'); closeSidebar();">
                <div class="icon"><i class="fas fa-money-bill-wave"></i></div>
                Dépôts
            </a>

            <div class="nav-label">Gestion</div>
            <a class="nav-link" href="anit.html" target="_blank">
                <div class="icon"><i class="fas fa-cog"></i></div>
                Page Anit
            </a>
        </nav>

        <div class="sidebar-bottom">
            <button class="btn-logout" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                Déconnexion
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main">
        <div class="content">

            <!-- Page Header -->
            <div class="page-header">
                <h1 class="page-title">Tableau de <span>bord Créateur</span></h1>
                <div class="header-right">
                    <button class="icon-btn" id="desktopNotifBtn" onclick="toggleNotifPanel()" style="display:flex;">
                        <i class="fas fa-bell"></i>
                        <span class="badge-dot" id="badgeDotDesktop" style="display:none;"></span>
                    </button>
                    <button class="btn btn-primary" onclick="openEventModal()">
                        <i class="fas fa-plus"></i>
                        Nouvel événement
                    </button>
                </div>
            </div>

            <!-- Commission Banner -->
            <div class="commission-banner">
                <div class="commission-left">
                    <div class="commission-icon"><i class="fas fa-coins"></i></div>
                    <div>
                        <div class="commission-label">Commission Predikta</div>
                        <div class="commission-value" id="totalCommission">0 FCFA</div>
                        <div class="commission-desc">2% sur le pot des perdants — gains garantis</div>
                    </div>
                </div>
            </div>

            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-card purple">
                    <div class="stat-icon-wrap purple"><i class="fas fa-users"></i></div>
                    <div class="stat-info">
                        <div class="stat-val" id="statUsers">0</div>
                        <div class="stat-lbl">Utilisateurs</div>
                    </div>
                </div>
                <div class="stat-card green">
                    <div class="stat-icon-wrap green"><i class="fas fa-calendar-check"></i></div>
                    <div class="stat-info">
                        <div class="stat-val" id="statEvents">0</div>
                        <div class="stat-lbl">Événements actifs</div>
                    </div>
                </div>
                <div class="stat-card orange">
                    <div class="stat-icon-wrap orange"><i class="fas fa-ticket-alt"></i></div>
                    <div class="stat-info">
                        <div class="stat-val" id="statBets">0</div>
                        <div class="stat-lbl">Total paris</div>
                    </div>
                </div>
                <div class="stat-card blue">
                    <div class="stat-icon-wrap blue"><i class="fas fa-coins"></i></div>
                    <div class="stat-info">
                        <div class="stat-val" id="statPot">0</div>
                        <div class="stat-lbl">Pot total (FCFA)</div>
                    </div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs-bar">
                <button class="tab-btn active" onclick="showTab('overview')">Vue d'ensemble</button>
                <button class="tab-btn" onclick="showTab('events')">Événements</button>
                <button class="tab-btn" onclick="showTab('results')">Résultats</button>
                <button class="tab-btn" onclick="showTab('users')">Utilisateurs</button>
                <button class="tab-btn" onclick="showTab('deposits')">Dépôts</button>
            </div>

            <!-- ── Overview ── -->
            <div class="tab-pane active" id="overviewPane">
                <div class="grid-2">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-fire"></i> Événements récents</div>
                            <button class="btn btn-ghost btn-sm" onclick="showTab('events')">Voir tout</button>
                        </div>
                        <div id="recentEventsList">
                            <div class="empty"><i class="fas fa-circle-notch fa-spin"></i><p>Chargement…</p></div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title"><i class="fas fa-money-bill-wave"></i> Derniers dépôts</div>
                            <button class="btn btn-ghost btn-sm" onclick="showTab('deposits')">Voir tout</button>
                        </div>
                        <div id="recentDepositsList">
                            <div class="empty"><i class="fas fa-circle-notch fa-spin"></i><p>Chargement…</p></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ── Events ── -->
            <div class="tab-pane" id="eventsPane">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><i class="fas fa-calendar-alt"></i> Tous les événements</div>
                    </div>
                    <div class="table-wrap">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Question</th>
                                    <th>Catégorie</th>
                                    <th>OUI</th>
                                    <th>NON</th>
                                    <th>Pot</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="eventsTableBody">
                                <tr><td colspan="8" style="text-align:center;padding:2rem;color:var(--text-muted);">Chargement…</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ── Results ── -->
            <div class="tab-pane" id="resultsPane">
                <div class="card" style="margin-bottom:1.25rem;">
                    <div class="card-header">
                        <div class="card-title"><i class="fas fa-trophy"></i> Événements en attente</div>
                    </div>
                    <div id="pendingResultsList">
                        <div class="empty"><i class="fas fa-circle-notch fa-spin"></i><p>Chargement…</p></div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><i class="fas fa-history"></i> Résultats annoncés</div>
                    </div>
                    <div id="announcedResultsList">
                        <div class="empty"><i class="fas fa-circle-notch fa-spin"></i><p>Chargement…</p></div>
                    </div>
                </div>
            </div>

            <!-- ── Users ── -->
            <div class="tab-pane" id="usersPane">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><i class="fas fa-users"></i> Tous les utilisateurs</div>
                    </div>
                    <div class="table-wrap">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th><th>Nom</th><th>Pseudo</th><th>Contact</th><th>Solde</th><th>Paris</th><th>Date</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <tr><td colspan="7" style="text-align:center;padding:2rem;color:var(--text-muted);">Chargement…</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ── Deposits ── -->
            <div class="tab-pane" id="depositsPane">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title"><i class="fas fa-money-bill-wave"></i> Tous les dépôts</div>
                    </div>
                    <div class="table-wrap">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th><th>Utilisateur</th><th>Montant</th><th>Date</th><th>Statut</th><th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="depositsTableBody">
                                <tr><td colspan="6" style="text-align:center;padding:2rem;color:var(--text-muted);">Chargement…</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div><!-- /content -->
    </main>
</div><!-- /layout -->

<!-- ── Event Modal ── -->
<div class="modal-overlay" id="eventModal">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-title">Créer un événement</div>
            <button class="modal-close" onclick="closeEventModal()"><i class="fas fa-times"></i></button>
        </div>
        <form id="eventForm" onsubmit="createEvent(event)">
            <div class="form-group">
                <label class="form-label">Question *</label>
                <input type="text" class="form-control" id="eventQuestion" placeholder="Ex: Le Sénégal va-t-il gagner la CAN ?" required>
            </div>
            <div class="form-group">
                <label class="form-label">Catégorie *</label>
                <select class="form-control" id="eventCategory" required>
                    <option value="sport">Sport</option>
                    <option value="politique">Politique</option>
                    <option value="entertainment">Divertissement</option>
                    <option value="crypto">Crypto</option>
                    <option value="autre">Autre</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Mise minimale (FCFA) *</label>
                <input type="number" class="form-control" id="eventMinBet" value="100" min="100" required>
            </div>
            <div class="form-group">
                <label class="form-label">Date de fin *</label>
                <input type="datetime-local" class="form-control" id="eventEndDate" required>
            </div>
            <div class="form-group">
                <label class="form-label">Description (optionnel)</label>
                <textarea class="form-control" id="eventDescription" placeholder="Description de l'événement…"></textarea>
            </div>
            <button type="submit" class="btn btn-primary btn-full" id="createEventBtn">
                <i class="fas fa-plus"></i> Créer l'événement
            </button>
        </form>
    </div>
</div>

<!-- ── Result Modal ── -->
<div class="modal-overlay" id="resultModal">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-title">Annoncer le résultat</div>
            <button class="modal-close" onclick="closeResultModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="summary-box" id="resultEventSummary"></div>
        <div class="form-group">
            <label class="form-label">Sélectionnez le résultat gagnant</label>
            <div class="result-opts">
                <div class="result-opt yes-opt" onclick="selectResult('yes')">
                    <i class="fas fa-check-circle"></i>
                    <h4>OUI</h4>
                    <p>Les parieurs OUI gagnent</p>
                </div>
                <div class="result-opt no-opt" onclick="selectResult('no')">
                    <i class="fas fa-times-circle"></i>
                    <h4>NON</h4>
                    <p>Les parieurs NON gagnent</p>
                </div>
            </div>
        </div>
        <div id="resultPreview" style="display:none;">
            <div class="summary-box">
                <div class="summary-row">
                    <span class="summary-key">Gagnants</span>
                    <span class="summary-val" id="winnersCount" style="color:var(--success);">0</span>
                </div>
                <div class="summary-row">
                    <span class="summary-key">Perdants</span>
                    <span class="summary-val" id="losersCount" style="color:var(--danger);">0</span>
                </div>
                <div class="summary-row">
                    <span class="summary-key">Pot redistribué</span>
                    <span class="summary-val" id="redistributionAmount">0 FCFA</span>
                </div>
                <div class="summary-row">
                    <span class="summary-key">Commission (2%)</span>
                    <span class="summary-val" id="commissionAmount">0 FCFA</span>
                </div>
                <div class="summary-row">
                    <span class="summary-key">Gain par gagnant</span>
                    <span class="summary-val" id="gainPerWinner" style="color:var(--success);">0 FCFA</span>
                </div>
            </div>
        </div>
        <button class="btn btn-success btn-full" onclick="confirmResult()" id="confirmResultBtn" disabled>
            <i class="fas fa-trophy"></i> Confirmer le résultat
        </button>
    </div>
</div>

<!-- Toast -->
<div class="toast" id="toast">
    <i class="fas fa-check-circle"></i>
    <span id="toastMsg">Message</span>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-messaging-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCPGgtXoDUycykLaTSee0S0yY0tkeJpqKI",
        authDomain: "data-com-a94a8.firebaseapp.com",
        databaseURL: "https://data-com-a94a8-default-rtdb.firebaseio.com",
        projectId: "data-com-a94a8",
        storageBucket: "data-com-a94a8.firebasestorage.app",
        messagingSenderId: "276904640935",
        appId: "1:276904640935:web:9cd805aeba6c34c767f682",
        measurementId: "G-FYQCWY5G4S"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const messaging = firebase.messaging();
    const vapidKey = "PViQXia_vvFLKMAe2E2q5oTOX48XpRQIdx5P4xAFEPw";

    let currentUser = null;
    let currentResultEvent = null;
    let selectedResult = null;
    let notifications = [];

    // ── Sidebar ──
    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('open');
        document.getElementById('sidebarOverlay').classList.toggle('active');
    }
    function closeSidebar() {
        document.getElementById('sidebar').classList.remove('open');
        document.getElementById('sidebarOverlay').classList.remove('active');
    }

    // ── Notifications ──
    function toggleNotifPanel() {
        const panel = document.getElementById('notifPanel');
        const ov = document.getElementById('notifOverlay');
        const isOpen = panel.classList.contains('active');
        if (isOpen) { closeNotifPanel(); } else {
            panel.classList.add('active');
            ov.classList.add('active');
            renderNotifications();
        }
    }
    function closeNotifPanel() {
        document.getElementById('notifPanel').classList.remove('active');
        document.getElementById('notifOverlay').classList.remove('active');
    }

    function renderNotifications() {
        const list = document.getElementById('notifList');
        if (!notifications.length) {
            list.innerHTML = '<div class="empty"><i class="fas fa-bell-slash"></i><p>Aucune notification</p></div>';
            return;
        }
        list.innerHTML = notifications.map(n => `
            <div class="notif-item ${n.type}">
                <div class="notif-item-title">${n.title}</div>
                <div class="notif-item-msg">${n.message}</div>
                <div class="notif-item-time">${n.time}</div>
            </div>
        `).join('');
    }

    function addNotification(title, message, type = 'info') {
        notifications.unshift({ id: Date.now(), title, message, type, read: false, time: new Date().toLocaleTimeString('fr-FR') });
        updateBadge();
    }
    function updateBadge() {
        const count = notifications.filter(n => !n.read).length;
        ['badgeDot','badgeDotDesktop'].forEach(id => {
            const el = document.getElementById(id);
            if (el) el.style.display = count > 0 ? 'block' : 'none';
        });
    }

    // ── FCM ──
    function initMessaging() {
        if (!('serviceWorker' in navigator)) return;
        navigator.serviceWorker.register('firebase-messaging-sw.js').then(reg => {
            messaging.getToken({ vapidKey, serviceWorkerRegistration: reg })
                .then(token => { if (token && currentUser) saveToken(token); })
                .catch(console.error);
        }).catch(console.error);

        messaging.onMessage(payload => {
            addNotification(payload.notification.title, payload.notification.body, 'info');
            showToast(payload.notification.body, 'success');
        });
    }

    function saveToken(token) {
        db.collection('users').doc(currentUser.id).update({
            fcmToken: token,
            tokenUpdatedAt: firebase.firestore.FieldValue.serverTimestamp()
        }).catch(console.error);
    }

    // ── Tabs ──
    function showTab(tab) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabNames = ['overview','events','results','users','deposits'];
        const idx = tabNames.indexOf(tab);
        if (idx >= 0 && tabBtns[idx]) tabBtns[idx].classList.add('active');

        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
        const pane = document.getElementById(tab + 'Pane');
        if (pane) pane.classList.add('active');

        if (tab === 'events') loadEventsTable();
        if (tab === 'users') loadUsersTable();
        if (tab === 'deposits') loadDepositsTable();
        if (tab === 'results') { loadPendingResults(); loadAnnouncedResults(); }
    }

    // ── Auth ──
    document.addEventListener('DOMContentLoaded', () => {
        checkAuth();
        Notification.requestPermission().then(p => { if (p === 'granted') initMessaging(); });
    });

    function checkAuth() {
        const user = JSON.parse(sessionStorage.getItem('currentUser'));
        if (!user || (user.role !== 'admin' && user.role !== 'creator')) {
            window.location.href = 'index.html'; return;
        }
        currentUser = user;
        document.getElementById('userAvatar').textContent = currentUser.prenom.charAt(0).toUpperCase();
        document.getElementById('userName').textContent = currentUser.prenom + ' ' + currentUser.nom;
        updateStats(); loadRecentEvents(); loadRecentDeposits();
        loadEventsTable(); loadUsersTable(); loadDepositsTable();
        calculateCommission(); loadPendingResults(); loadAnnouncedResults();
    }

    // ── Stats ──
    function updateStats() {
        db.collection('users').get().then(s => document.getElementById('statUsers').textContent = s.size);
        db.collection('events').where('status','==','active').get().then(s => document.getElementById('statEvents').textContent = s.size);
        db.collection('bets').get().then(s => {
            document.getElementById('statBets').textContent = s.size;
            let pot = 0;
            s.forEach(d => pot += d.data().amount || 0);
            document.getElementById('statPot').textContent = pot.toLocaleString();
        });
    }

    function calculateCommission() {
        db.collection('events').where('status','==','closed').get().then(s => {
            let total = 0;
            s.forEach(d => {
                const ev = d.data();
                if (ev.winner && ev.bets) {
                    const loserTotal = ev.bets.filter(b => b.choice !== ev.winner).reduce((sum,b) => sum + b.amount, 0);
                    total += loserTotal * 0.02;
                }
            });
            document.getElementById('totalCommission').textContent = Math.floor(total).toLocaleString() + ' FCFA';
        });
    }

    // ── Utils ──
    function getCatIcon(cat) {
        return { sport:'futbol', politique:'landmark', entertainment:'film', crypto:'bitcoin', autre:'tag' }[cat] || 'tag';
    }

    function fmt(n) { return (n||0).toLocaleString(); }

    // ── Recent Events ──
    function loadRecentEvents() {
        db.collection('events').get().then(snap => {
            const container = document.getElementById('recentEventsList');
            if (snap.empty) { container.innerHTML = '<div class="empty"><i class="fas fa-calendar-plus"></i><p>Aucun événement</p></div>'; return; }
            let events = snap.docs.map(d => ({id:d.id,...d.data()}))
                .sort((a,b) => (b.createdAt?.toMillis()||0) - (a.createdAt?.toMillis()||0))
                .slice(0,3);
            container.innerHTML = events.map(ev => eventCardHTML(ev)).join('');
        }).catch(console.error);
    }

    function eventCardHTML(ev) {
        const yes = (ev.bets||[]).filter(b=>b.choice==='yes');
        const no  = (ev.bets||[]).filter(b=>b.choice==='no');
        const pot = (ev.bets||[]).reduce((s,b)=>s+b.amount,0);
        return `
        <div class="event-card">
            <div class="event-card-top">
                <span class="cat-tag"><i class="fas fa-${getCatIcon(ev.category)}"></i> ${ev.category||'sport'}</span>
                <span class="badge ${ev.status}">${ev.status==='active'?'Actif':'Clôturé'}</span>
            </div>
            <div class="event-q">${ev.question}</div>
            <div class="event-meta">
                <span class="meta-item yes"><i class="fas fa-check-circle"></i> ${yes.length} OUI</span>
                <span class="meta-item no"><i class="fas fa-times-circle"></i> ${no.length} NON</span>
                <span class="meta-item pot"><i class="fas fa-coins"></i> ${fmt(pot)} FCFA</span>
            </div>
        </div>`;
    }

    // ── Recent Deposits ──
    function loadRecentDeposits() {
        db.collection('deposit_requests').get().then(snap => {
            const container = document.getElementById('recentDepositsList');
            if (snap.empty) { container.innerHTML = '<div class="empty"><i class="fas fa-money-bill-wave"></i><p>Aucun dépôt</p></div>'; return; }
            let deps = snap.docs.map(d=>({id:d.id,...d.data()}))
                .sort((a,b) => (b.createdAt?.toMillis()||0) - (a.createdAt?.toMillis()||0))
                .slice(0,3);
            const labels = { pending:'En attente', approved:'Approuvé', rejected:'Rejeté' };
            container.innerHTML = deps.map(dep => `
                <div class="event-card">
                    <div class="event-card-top">
                        <span class="cat-tag"><i class="fas fa-user"></i> ${dep.userName||'Utilisateur'}</span>
                        <span class="badge ${dep.status}">${labels[dep.status]||dep.status}</span>
                    </div>
                    <div class="event-q">${fmt(dep.amount)} FCFA</div>
                    <div class="event-meta">
                        <span class="meta-item pot"><i class="fas fa-calendar"></i> ${dep.createdAt?dep.createdAt.toDate().toLocaleDateString('fr-FR'):'-'}</span>
                    </div>
                </div>
            `).join('');
        }).catch(console.error);
    }

    // ── Events Table ──
    function loadEventsTable() {
        db.collection('events').get().then(snap => {
            const tbody = document.getElementById('eventsTableBody');
            if (snap.empty) { tbody.innerHTML = '<tr><td colspan="8" style="text-align:center;padding:2rem;color:var(--text-muted);">Aucun événement</td></tr>'; return; }
            let events = snap.docs.map(d=>({id:d.id,...d.data()}))
                .sort((a,b) => (b.createdAt?.toMillis()||0) - (a.createdAt?.toMillis()||0));
            tbody.innerHTML = events.map(({id,...ev}) => {
                const yes = (ev.bets||[]).filter(b=>b.choice==='yes').length;
                const no  = (ev.bets||[]).filter(b=>b.choice==='no').length;
                const pot = (ev.bets||[]).reduce((s,b)=>s+b.amount,0);
                return `<tr>
                    <td style="color:var(--text-muted);font-size:0.75rem;">#${id.substr(-6)}</td>
                    <td style="max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${ev.question}</td>
                    <td>${ev.category||'sport'}</td>
                    <td style="color:var(--success);">${yes}</td>
                    <td style="color:var(--danger);">${no}</td>
                    <td style="color:var(--text);">${fmt(pot)}</td>
                    <td><span class="badge ${ev.status}">${ev.status==='active'?'Actif':'Clôturé'}</span></td>
                    <td>
                        <div class="actions">
                            <button class="act-btn view" onclick="viewEvent('${id}')" title="Voir"><i class="fas fa-eye"></i></button>
                            ${ev.status==='active'?`<button class="act-btn result" onclick="openResultModal('${id}')" title="Résultat"><i class="fas fa-trophy"></i></button>`:''}
                            <button class="act-btn del" onclick="deleteEvent('${id}')" title="Supprimer"><i class="fas fa-trash"></i></button>
                        </div>
                    </td>
                </tr>`;
            }).join('');
        }).catch(console.error);
    }

    // ── Pending Results ──
    function loadPendingResults() {
        db.collection('events').where('status','==','active').get().then(snap => {
            const container = document.getElementById('pendingResultsList');
            if (snap.empty) {
                container.innerHTML = '<div class="empty"><i class="fas fa-check-circle" style="color:var(--success);opacity:1;"></i><h4>Aucun en attente</h4><p>Tous les résultats ont été annoncés</p></div>';
                return;
            }
            let events = snap.docs.map(d=>({id:d.id,...d.data()})).sort((a,b)=>(b.createdAt?.toMillis()||0)-(a.createdAt?.toMillis()||0));
            container.innerHTML = events.map(ev => {
                const yes = (ev.bets||[]).filter(b=>b.choice==='yes');
                const no  = (ev.bets||[]).filter(b=>b.choice==='no');
                const pot = (ev.bets||[]).reduce((s,b)=>s+b.amount,0);
                return `
                <div class="event-card">
                    <div class="event-card-top">
                        <span class="cat-tag"><i class="fas fa-${getCatIcon(ev.category)}"></i> ${ev.category||'sport'}</span>
                        <span class="badge active">En cours</span>
                    </div>
                    <div class="event-q">${ev.question}</div>
                    <div class="event-meta" style="margin-bottom:0.875rem;">
                        <span class="meta-item yes"><i class="fas fa-check-circle"></i> ${yes.length} OUI (${fmt(yes.reduce((s,b)=>s+b.amount,0))} FCFA)</span>
                        <span class="meta-item no"><i class="fas fa-times-circle"></i> ${no.length} NON (${fmt(no.reduce((s,b)=>s+b.amount,0))} FCFA)</span>
                        <span class="meta-item pot"><i class="fas fa-coins"></i> ${fmt(pot)} FCFA</span>
                    </div>
                    <button class="btn btn-success" onclick="openResultModal('${ev.id}')" style="width:100%;justify-content:center;">
                        <i class="fas fa-trophy"></i> Annoncer le résultat
                    </button>
                </div>`;
            }).join('');
        }).catch(err => {
            document.getElementById('pendingResultsList').innerHTML = `<div class="empty"><i class="fas fa-exclamation-triangle"></i><h4>Erreur</h4><p>${err.message}</p></div>`;
        });
    }

    // ── Announced Results ──
    function loadAnnouncedResults() {
        db.collection('events').where('status','==','closed').get().then(snap => {
            const container = document.getElementById('announcedResultsList');
            if (snap.empty) { container.innerHTML = '<div class="empty"><i class="fas fa-history"></i><h4>Aucun résultat annoncé</h4><p>Les résultats apparaîtront ici</p></div>'; return; }
            let events = snap.docs.map(d=>({id:d.id,...d.data()})).sort((a,b)=>(b.closedAt?.toMillis()||0)-(a.closedAt?.toMillis()||0));
            container.innerHTML = events.map(ev => {
                const yes = (ev.bets||[]).filter(b=>b.choice==='yes');
                const no  = (ev.bets||[]).filter(b=>b.choice==='no');
                const winners = ev.winner==='yes'?yes:no;
                const losers  = ev.winner==='yes'?no:yes;
                const loserTotal = losers.reduce((s,b)=>s+b.amount,0);
                const comm = loserTotal*0.02;
                const gain = winners.length ? (loserTotal-comm)/winners.length : 0;
                return `
                <div class="event-card" style="border-left:3px solid ${ev.winner==='yes'?'var(--success)':'var(--danger)'};">
                    <div class="event-card-top">
                        <span class="cat-tag"><i class="fas fa-${getCatIcon(ev.category)}"></i> ${ev.category||'sport'}</span>
                        <span class="badge closed">Terminé</span>
                    </div>
                    <div class="event-q">${ev.question}</div>
                    <div class="summary-box" style="margin-top:0.75rem;">
                        <div class="summary-row">
                            <span class="summary-key">Résultat</span>
                            <span class="summary-val" style="color:${ev.winner==='yes'?'var(--success)':'var(--danger)'};">${ev.winner==='yes'?'OUI':'NON'}</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-key">Gagnants</span>
                            <span class="summary-val" style="color:var(--success);">${winners.length} personnes</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-key">Perdants</span>
                            <span class="summary-val" style="color:var(--danger);">${losers.length} personnes</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-key">Gain/gagnant</span>
                            <span class="summary-val" style="color:var(--success);">+${fmt(Math.floor(gain))} FCFA</span>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }).catch(err => {
            document.getElementById('announcedResultsList').innerHTML = `<div class="empty"><i class="fas fa-exclamation-triangle"></i><h4>Erreur</h4><p>${err.message}</p></div>`;
        });
    }

    // ── Users Table ──
    function loadUsersTable() {
        db.collection('users').get().then(snap => {
            const tbody = document.getElementById('usersTableBody');
            if (snap.empty) { tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;padding:2rem;color:var(--text-muted);">Aucun utilisateur</td></tr>'; return; }
            Promise.all(snap.docs.map(doc =>
                db.collection('bets').where('userId','==',doc.id).get().then(bs => ({ u:doc.data(), id:doc.id, bc:bs.size }))
            )).then(rows => {
                tbody.innerHTML = rows.map(({u,id,bc}) => `<tr>
                    <td style="color:var(--text-muted);font-size:0.75rem;">#${id.substr(-6)}</td>
                    <td>${u.prenom} ${u.nom}</td>
                    <td style="color:var(--primary-light);">@${u.pseudo}</td>
                    <td>${u.contact}</td>
                    <td style="color:var(--success);">${fmt(u.balance||0)}</td>
                    <td>${bc}</td>
                    <td>${u.createdAt?u.createdAt.toDate().toLocaleDateString('fr-FR'):'-'}</td>
                </tr>`).join('');
            });
        }).catch(console.error);
    }

    // ── Deposits Table ──
    function loadDepositsTable() {
        db.collection('deposit_requests').get().then(snap => {
            const tbody = document.getElementById('depositsTableBody');
            if (snap.empty) { tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;padding:2rem;color:var(--text-muted);">Aucun dépôt</td></tr>'; return; }
            const labels = { pending:'En attente', approved:'Approuvé', rejected:'Rejeté' };
            let deps = snap.docs.map(d=>({id:d.id,...d.data()})).sort((a,b)=>(b.createdAt?.toMillis()||0)-(a.createdAt?.toMillis()||0));
            tbody.innerHTML = deps.map(({id,...d}) => `<tr>
                <td style="color:var(--text-muted);font-size:0.75rem;">#${id.substr(-6)}</td>
                <td>${d.userName||'Inconnu'}</td>
                <td style="color:var(--text);">${fmt(d.amount)} FCFA</td>
                <td>${d.createdAt?d.createdAt.toDate().toLocaleDateString('fr-FR'):'-'}</td>
                <td><span class="badge ${d.status}">${labels[d.status]||d.status}</span></td>
                <td><div class="actions"><button class="act-btn view" onclick="window.open('anit.html','_blank')"><i class="fas fa-eye"></i></button></div></td>
            </tr>`).join('');
        }).catch(console.error);
    }

    // ── Event Modal ──
    function openEventModal() {
        const d = new Date(); d.setDate(d.getDate()+7);
        d.setMinutes(d.getMinutes()-d.getTimezoneOffset());
        document.getElementById('eventEndDate').value = d.toISOString().slice(0,16);
        document.getElementById('eventModal').classList.add('active');
    }
    function closeEventModal() {
        document.getElementById('eventModal').classList.remove('active');
        document.getElementById('eventForm').reset();
    }

    function createEvent(e) {
        e.preventDefault();
        const btn = document.getElementById('createEventBtn');
        btn.innerHTML = '<span class="spin"></span> Création…'; btn.disabled = true;
        db.collection('events').add({
            question: document.getElementById('eventQuestion').value,
            category: document.getElementById('eventCategory').value,
            minBet:   parseInt(document.getElementById('eventMinBet').value),
            endDate:  document.getElementById('eventEndDate').value,
            description: document.getElementById('eventDescription').value,
            status: 'active', bets: [],
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            createdBy: currentUser.id
        }).then(() => {
            showToast('Événement créé avec succès !', 'success');
            closeEventModal(); updateStats(); loadRecentEvents(); loadEventsTable(); loadPendingResults();
            btn.innerHTML = '<i class="fas fa-plus"></i> Créer l\'événement'; btn.disabled = false;
        }).catch(err => {
            showToast('Erreur: ' + err.message, 'error');
            btn.innerHTML = '<i class="fas fa-plus"></i> Créer l\'événement'; btn.disabled = false;
        });
    }

    // ── Result Modal ──
    function openResultModal(eventId) {
        db.collection('events').doc(eventId).get().then(doc => {
            if (!doc.exists) { showToast('Événement introuvable', 'error'); return; }
            currentResultEvent = { id: doc.id, ...doc.data() };
            selectedResult = null;
            const yes = (currentResultEvent.bets||[]).filter(b=>b.choice==='yes');
            const no  = (currentResultEvent.bets||[]).filter(b=>b.choice==='no');
            const yesT = yes.reduce((s,b)=>s+b.amount,0);
            const noT  = no.reduce((s,b)=>s+b.amount,0);
            document.getElementById('resultEventSummary').innerHTML = `
                <div class="summary-row"><span class="summary-key">Question</span><span class="summary-val" style="max-width:60%;text-align:right;">${currentResultEvent.question}</span></div>
                <div class="summary-row"><span class="summary-key">Paris OUI</span><span class="summary-val" style="color:var(--success);">${yes.length} (${fmt(yesT)} FCFA)</span></div>
                <div class="summary-row"><span class="summary-key">Paris NON</span><span class="summary-val" style="color:var(--danger);">${no.length} (${fmt(noT)} FCFA)</span></div>
                <div class="summary-row"><span class="summary-key">Pot total</span><span class="summary-val">${fmt(yesT+noT)} FCFA</span></div>`;
            document.querySelectorAll('.result-opt').forEach(el => el.classList.remove('selected','yes','no'));
            document.getElementById('resultPreview').style.display = 'none';
            document.getElementById('confirmResultBtn').disabled = true;
            document.getElementById('resultModal').classList.add('active');
        }).catch(err => showToast('Erreur: '+err.message,'error'));
    }
    function closeResultModal() {
        document.getElementById('resultModal').classList.remove('active');
        currentResultEvent = null; selectedResult = null;
    }

    function selectResult(result) {
        selectedResult = result;
        document.querySelectorAll('.result-opt').forEach(el => el.classList.remove('selected','yes','no'));
        document.querySelector(`.result-opt.${result}-opt`).classList.add('selected', result);
        const yes = (currentResultEvent.bets||[]).filter(b=>b.choice==='yes');
        const no  = (currentResultEvent.bets||[]).filter(b=>b.choice==='no');
        const winners = result==='yes'?yes:no;
        const losers  = result==='yes'?no:yes;
        const loserTotal = losers.reduce((s,b)=>s+b.amount,0);
        const comm = loserTotal*0.02;
        const redist = loserTotal-comm;
        const gain = winners.length ? redist/winners.length : 0;
        document.getElementById('winnersCount').textContent = winners.length;
        document.getElementById('losersCount').textContent = losers.length;
        document.getElementById('redistributionAmount').textContent = fmt(Math.floor(redist))+' FCFA';
        document.getElementById('commissionAmount').textContent = fmt(Math.floor(comm))+' FCFA';
        document.getElementById('gainPerWinner').textContent = '+'+fmt(Math.floor(gain))+' FCFA';
        document.getElementById('resultPreview').style.display = 'block';
        document.getElementById('confirmResultBtn').disabled = false;
    }

    function confirmResult() {
        if (!selectedResult||!currentResultEvent) return;
        const btn = document.getElementById('confirmResultBtn');
        btn.innerHTML = '<span class="spin"></span> Traitement…'; btn.disabled = true;
        const yes = (currentResultEvent.bets||[]).filter(b=>b.choice==='yes');
        const no  = (currentResultEvent.bets||[]).filter(b=>b.choice==='no');
        const winners = selectedResult==='yes'?yes:no;
        const losers  = selectedResult==='yes'?no:yes;
        const loserTotal = losers.reduce((s,b)=>s+b.amount,0);
        const comm = loserTotal*0.02;
        const redist = loserTotal-comm;
        const gain = winners.length ? redist/winners.length : 0;
        const batch = db.batch();
        batch.update(db.collection('events').doc(currentResultEvent.id), {
            status:'closed', winner:selectedResult,
            closedAt:firebase.firestore.FieldValue.serverTimestamp(),
            commission:comm, redistribution:redist
        });
        winners.forEach(wb => {
            batch.update(db.collection('users').doc(wb.userId), { balance:firebase.firestore.FieldValue.increment(wb.amount+gain) });
            db.collection('bets').where('userId','==',wb.userId).where('eventId','==',currentResultEvent.id).get()
                .then(s=>s.forEach(d=>batch.update(d.ref,{status:'won',gain,result:selectedResult,updatedAt:firebase.firestore.FieldValue.serverTimestamp()})));
        });
        losers.forEach(lb => {
            db.collection('bets').where('userId','==',lb.userId).where('eventId','==',currentResultEvent.id).get()
                .then(s=>s.forEach(d=>batch.update(d.ref,{status:'lost',gain:0,result:selectedResult,updatedAt:firebase.firestore.FieldValue.serverTimestamp()})));
        });
        batch.commit().then(() => {
            showToast('Résultat annoncé ! Gains distribués.', 'success');
            addNotification('Résultat annoncé', `"${currentResultEvent.question}" → ${selectedResult==='yes'?'OUI':'NON'}`, 'success');
            closeResultModal(); loadRecentEvents(); loadEventsTable();
            loadPendingResults(); loadAnnouncedResults(); calculateCommission();
            btn.innerHTML = '<i class="fas fa-trophy"></i> Confirmer le résultat'; btn.disabled = false;
        }).catch(err => {
            showToast('Erreur: '+err.message, 'error');
            btn.innerHTML = '<i class="fas fa-trophy"></i> Confirmer le résultat'; btn.disabled = false;
        });
    }

    function viewEvent(id) {
        db.collection('events').doc(id).get().then(doc => {
            if (!doc.exists) return;
            const ev = doc.data();
            const yes = (ev.bets||[]).filter(b=>b.choice==='yes');
            const no  = (ev.bets||[]).filter(b=>b.choice==='no');
            alert(`#${id.substr(-6)}\n\n${ev.question}\nCatégorie: ${ev.category}\nStatut: ${ev.status}\n\nOUI: ${yes.length} (${fmt(yes.reduce((s,b)=>s+b.amount,0))} FCFA)\nNON: ${no.length} (${fmt(no.reduce((s,b)=>s+b.amount,0))} FCFA)\nPot: ${fmt((ev.bets||[]).reduce((s,b)=>s+b.amount,0))} FCFA`);
        });
    }

    function deleteEvent(id) {
        if (!confirm('Supprimer cet événement ?')) return;
        db.collection('events').doc(id).delete().then(() => {
            showToast('Événement supprimé', 'success');
            loadRecentEvents(); loadEventsTable(); loadPendingResults(); updateStats();
        }).catch(err => showToast('Erreur: '+err.message,'error'));
    }

    function showToast(msg, type='success') {
        const toast = document.getElementById('toast');
        toast.querySelector('i').className = type==='success' ? 'fas fa-check-circle' : 'fas fa-exclamation-circle';
        document.getElementById('toastMsg').textContent = msg;
        toast.className = 'toast show ' + type;
        setTimeout(() => toast.classList.remove('show'), 3500);
    }

    function logout() {
        sessionStorage.removeItem('currentUser');
        showToast('Déconnexion réussie', 'success');
        setTimeout(() => window.location.href = 'index.html', 1000);
    }
</script>
</body>
</html>
